{
  "version": "2.0_phase1",
  "last_updated": "2025-10-21T03:49:44.838895",
  "updated_by": "claude_optimizer",
  "description": "Phase 1: Enhanced for trend holding with tiered entries and dynamic exits",
  "ribbon_state_thresholds": {
    "all_green": 0.92,
    "strong_green": 0.75,
    "weak_green": 0.5,
    "mixed": 0.33,
    "all_red": 0.92,
    "strong_red": 0.75,
    "weak_red": 0.5
  },
  "entry_rules": {
    "ribbon_alignment_threshold": 0.995,
    "min_light_emas_required": 28,
    "ribbon_states_allowed_long": [
      "all_green",
      "strong_green"
    ],
    "ribbon_states_allowed_short": [
      "all_red",
      "strong_red"
    ],
    "fresh_transition_max_minutes": 15,
    "stale_transition_min_minutes": 30,
    "entry_tiers": {
      "tier_1_strong_trend": {
        "enabled": true,
        "description": "Strong trending conditions - hold aggressively",
        "ribbon_states_long": [
          "all_green"
        ],
        "ribbon_states_short": [
          "all_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 5,
        "entry_confidence_base": 0.85,
        "timeframe_alignment_required": false
      },
      "tier_2_moderate_trend": {
        "enabled": true,
        "description": "Moderate trending conditions - normal holds",
        "ribbon_states_long": [
          "all_green",
          "strong_green"
        ],
        "ribbon_states_short": [
          "all_red",
          "strong_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 3,
        "entry_confidence_base": 0.75,
        "timeframe_alignment_required": false
      },
      "tier_3_quick_scalp": {
        "enabled": false,
        "description": "Weak/choppy conditions - quick scalps only (DISABLED for now)",
        "ribbon_states_long": [
          "weak_green"
        ],
        "ribbon_states_short": [
          "weak_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 1,
        "entry_confidence_base": 0.6,
        "timeframe_alignment_required": true
      }
    },
    "min_compression_for_entry": 0.0015
  },
  "exit_rules": {
    "max_hold_minutes": 300,
    "tier_1_strong_trend": {
      "description": "Exit rules for strong trend entries (all_green/all_red with 11+ light EMAs)",
      "min_hold_minutes": 15,
      "profit_target_pct": 0.0096,
      "stop_loss_pct": 0.006,
      "exit_on_ribbon_flip": false,
      "exit_on_opposite_strong_state": true,
      "exit_on_weak_state": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 60,
      "trailing_buffer_pct": 0.0015,
      "min_light_emas_to_hold": 8
    },
    "tier_2_moderate_trend": {
      "description": "Exit rules for moderate trend entries (strong_green/strong_red with 8+ light EMAs)",
      "min_hold_minutes": 9,
      "profit_target_pct": 0.008,
      "stop_loss_pct": 0.005,
      "exit_on_ribbon_flip": false,
      "exit_on_opposite_state": true,
      "exit_on_weak_state": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 30,
      "trailing_buffer_pct": 0.0015,
      "min_light_emas_to_hold": 6
    },
    "tier_3_quick_scalp": {
      "description": "Exit rules for quick scalp entries (weak conditions)",
      "min_hold_minutes": 4,
      "profit_target_pct": 0.004,
      "stop_loss_pct": 0.003,
      "exit_on_ribbon_flip": true,
      "exit_on_any_state_change": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 15,
      "trailing_buffer_pct": 0.00075,
      "min_light_emas_to_hold": 4
    },
    "min_hold_time_minutes": 15,
    "exit_on_ribbon_flip": false,
    "exit_on_target_only": false,
    "profit_target_pct": 0.008,
    "use_yellow_ema_trail": true,
    "yellow_ema_trail_buffer_pct": 0.0015
  },
  "trend_strength_analysis": {
    "enabled": true,
    "description": "Calculate trend strength score to validate entries and exits",
    "light_ema_ratio_weight": 25,
    "ema_spread_weight": 20,
    "ribbon_stability_weight": 20,
    "slope_alignment_weight": 20,
    "price_conviction_weight": 15,
    "thresholds": {
      "strong_trend": 70,
      "moderate_trend": 50,
      "weak_trend": 30
    },
    "ema_spread_thresholds": {
      "expanding": 0.003,
      "stable": 0.001,
      "compressing": 0.0005
    },
    "ribbon_stability_thresholds": {
      "very_stable": 20,
      "stable": 10,
      "unstable": 5
    }
  },
  "choppy_market_detection": {
    "enabled": true,
    "description": "Detect and avoid choppy/ranging market conditions",
    "flip_count_30min_threshold": 5,
    "ema_compression_threshold": 0.0005,
    "light_ema_changes_5min_threshold": 6,
    "avoid_entry_choppy_score": 70,
    "exit_if_choppy_score": 60
  },
  "pattern_rules": {
    "path_e_dark_transition": {
      "enabled": true,
      "priority": 2,
      "confidence_boost": 0.15,
      "entry_window_seconds": 10
    },
    "path_d_early_reversal": {
      "enabled": true,
      "priority": 4,
      "min_light_emas_opposite": 8,
      "min_green_appearing": 2,
      "confidence_threshold": 0.75
    },
    "path_c_wick_reversal": {
      "enabled": true,
      "priority": 3,
      "min_wick_pct": 0.003,
      "max_wick_pct": 0.008,
      "confidence_boost": 0.2
    },
    "path_a_trending": {
      "enabled": true,
      "priority": 5,
      "min_range_pct": 0.005,
      "price_location_lower_pct": 0.5,
      "price_location_upper_pct": 0.5,
      "min_alignment_pct": 0.85
    },
    "path_b_breakout": {
      "enabled": true,
      "priority": 6,
      "max_range_pct": 0.004,
      "min_breakout_pct": 0.0015,
      "ribbon_flip_max_minutes": 8
    },
    "path_f_momentum_surge": {
      "enabled": true,
      "priority": 1,
      "min_light_emas": 25,
      "ignore_all_other_filters": true,
      "confidence_boost": 0.9,
      "special_profit_target_pct": 0.008,
      "entry_window_seconds": 300,
      "upward_bias_multiplier": 1.5
    }
  },
  "performance_metrics": {
    "total_trades_executed": 0,
    "winning_trades": 0,
    "losing_trades": 0,
    "win_rate": 0.0,
    "avg_winner_pnl_pct": 0.0,
    "avg_loser_pnl_pct": 0.0,
    "best_pattern": "unknown",
    "worst_pattern": "unknown",
    "tier_1_trades": 0,
    "tier_2_trades": 0,
    "tier_3_trades": 0,
    "tier_1_avg_hold_minutes": 0,
    "tier_2_avg_hold_minutes": 0,
    "tier_3_avg_hold_minutes": 0
  },
  "claude_insights": {
    "last_optimization": "2025-10-21T03:49:44.838767",
    "key_findings": [
      "Finding 1: CRITICAL EXECUTION FAILURE - Zero actual trades executed despite 1078 backtest trades indicates complete bot malfunction requiring immediate system diagnosis and repair",
      "Finding 2: EXTREME OVER-TRADING - Taking 11,977% more trades than optimal (1078 vs 9) while achieving negative performance (-0.22% vs +6.23%) shows catastrophic quality control failure",
      "Finding 3: MISSING BIG MOVEMENT DETECTION - No big movement analysis available means we're blind to the high-value momentum patterns that optimal trades likely captured",
      "Finding 4: PARADOXICAL SELECTIVITY - Despite ultra-strict thresholds (0.99 alignment, 25+ light EMAs), we're still taking 100x too many trades, suggesting filters aren't targeting the right patterns",
      "Finding 5: ZERO LEARNING FROM HISTORY - 40 rule versions with no documented improvements or regressions indicates optimization process isn't effectively learning from data"
    ],
    "pattern_recommendations": [
      "EMERGENCY PRIORITY: Immediately audit and fix bot execution system - check API connectivity, parameter parsing, trade execution logic, and real-time data synchronization",
      "IMPLEMENT MOMENTUM SURGE DETECTION: Create path_f_momentum_surge as highest priority pattern with ability to override all normal filters when significant price/volume action detected",
      "ADD BIG MOVEMENT EARLY WARNING: Implement volume surge (1.8x+ threshold) and price movement (0.006%+ threshold) detection to catch opportunities before they fully develop",
      "DRAMATICALLY REDUCE TRADE FREQUENCY: Target 90%+ reduction in trades by implementing ultra-selective criteria - aim for 10-20 trades maximum to match optimal frequency",
      "CREATE MOMENTUM OVERRIDE SYSTEM: Allow big movement patterns to bypass stale transition filters, position location restrictions, and compression requirements"
    ],
    "rule_adjustments": {
      "ribbon_alignment_threshold": 0.995,
      "min_light_emas_required": 28,
      "max_hold_minutes": 300,
      "entry_rules": {
        "NEW_big_movement_detection": {
          "enabled": true,
          "min_price_move_pct": 0.006,
          "volume_surge_threshold": 1.8,
          "ignore_stale_on_big_move": true
        },
        "NEW_momentum_filters": {
          "min_ema_spread_pct": 0.004,
          "dark_to_light_transition_boost": 0.3
        },
        "min_compression_for_entry": 0.0025,
        "fresh_transition_max_minutes": 8,
        "min_ribbon_stability_minutes": 10
      },
      "exit_rules": {
        "tier_1_strong_trend": {
          "min_hold_minutes": 25,
          "profit_target_pct": 0.015,
          "stop_loss_pct": 0.008,
          "exit_on_ribbon_flip": false,
          "exit_on_opposite_strong_state": false,
          "min_light_emas_to_hold": 12
        },
        "tier_2_moderate_trend": {
          "min_hold_minutes": 18,
          "profit_target_pct": 0.012,
          "stop_loss_pct": 0.007,
          "min_light_emas_to_hold": 10
        }
      },
      "pattern_rules": {
        "NEW_path_f_momentum_surge": {
          "enabled": true,
          "priority": 1,
          "min_light_emas": 30,
          "ignore_all_other_filters": true,
          "confidence_boost": 0.9,
          "special_profit_target_pct": 0.018,
          "entry_window_seconds": 120,
          "upward_bias_multiplier": 1.4
        },
        "NEW_big_movement_priority": {
          "enabled": true,
          "entry_overrides": {
            "ignore_stale_filter": true,
            "ignore_position_location_filter": true,
            "ignore_compression_filter": true
          }
        }
      },
      "path_priorities": {
        "NEW_path_f_momentum_surge": 1,
        "path_e_dark_transition": 2,
        "path_c_wick_reversal": 3,
        "path_d_early_reversal": 4,
        "path_a_trending": 5,
        "path_b_breakout": 6
      }
    },
    "reasoning": "The data reveals a complete system breakdown: zero actual trades despite extensive backtesting indicates critical execution failure requiring immediate technical repair. The 11,977% over-trading rate (1078 vs 9 optimal) with negative returns shows our filters are fundamentally misaligned with profitable patterns. The solution requires both emergency system fixes and radical selectivity increases. By implementing momentum surge detection with override capabilities and tightening all thresholds (0.995 alignment, 28+ light EMAs, 0.004 spread), we can dramatically reduce trade frequency while capturing the high-value patterns optimal found. The new path_f_momentum_surge with highest priority should catch big movements that bypass restrictive filters. Most critically, without actual trade execution, even perfect rules are worthless - the bot execution system must be debugged and repaired immediately."
  }
}