{
  "version": "2.0_phase1",
  "last_updated": "2025-10-21T04:03:31.331208",
  "updated_by": "claude_optimizer",
  "description": "Phase 1: Enhanced for trend holding with tiered entries and dynamic exits",
  "ribbon_state_thresholds": {
    "all_green": 0.92,
    "strong_green": 0.75,
    "weak_green": 0.5,
    "mixed": 0.33,
    "all_red": 0.92,
    "strong_red": 0.75,
    "weak_red": 0.5
  },
  "entry_rules": {
    "ribbon_alignment_threshold": 0.999,
    "min_light_emas_required": 35,
    "ribbon_states_allowed_long": [
      "all_green",
      "strong_green"
    ],
    "ribbon_states_allowed_short": [
      "all_red",
      "strong_red"
    ],
    "fresh_transition_max_minutes": 15,
    "stale_transition_min_minutes": 30,
    "entry_tiers": {
      "tier_1_strong_trend": {
        "enabled": true,
        "description": "Strong trending conditions - hold aggressively",
        "ribbon_states_long": [
          "all_green"
        ],
        "ribbon_states_short": [
          "all_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 5,
        "entry_confidence_base": 0.85,
        "timeframe_alignment_required": false
      },
      "tier_2_moderate_trend": {
        "enabled": true,
        "description": "Moderate trending conditions - normal holds",
        "ribbon_states_long": [
          "all_green",
          "strong_green"
        ],
        "ribbon_states_short": [
          "all_red",
          "strong_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 3,
        "entry_confidence_base": 0.75,
        "timeframe_alignment_required": false
      },
      "tier_3_quick_scalp": {
        "enabled": false,
        "description": "Weak/choppy conditions - quick scalps only (DISABLED for now)",
        "ribbon_states_long": [
          "weak_green"
        ],
        "ribbon_states_short": [
          "weak_red"
        ],
        "min_light_emas": 12,
        "min_ribbon_stability_minutes": 1,
        "entry_confidence_base": 0.6,
        "timeframe_alignment_required": true
      }
    },
    "min_compression_for_entry": 0.0015
  },
  "exit_rules": {
    "max_hold_minutes": 480,
    "tier_1_strong_trend": {
      "description": "Exit rules for strong trend entries (all_green/all_red with 11+ light EMAs)",
      "min_hold_minutes": 15,
      "profit_target_pct": 0.0096,
      "stop_loss_pct": 0.006,
      "exit_on_ribbon_flip": false,
      "exit_on_opposite_strong_state": true,
      "exit_on_weak_state": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 60,
      "trailing_buffer_pct": 0.0015,
      "min_light_emas_to_hold": 8
    },
    "tier_2_moderate_trend": {
      "description": "Exit rules for moderate trend entries (strong_green/strong_red with 8+ light EMAs)",
      "min_hold_minutes": 9,
      "profit_target_pct": 0.008,
      "stop_loss_pct": 0.005,
      "exit_on_ribbon_flip": false,
      "exit_on_opposite_state": true,
      "exit_on_weak_state": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 30,
      "trailing_buffer_pct": 0.0015,
      "min_light_emas_to_hold": 6
    },
    "tier_3_quick_scalp": {
      "description": "Exit rules for quick scalp entries (weak conditions)",
      "min_hold_minutes": 4,
      "profit_target_pct": 0.004,
      "stop_loss_pct": 0.003,
      "exit_on_ribbon_flip": true,
      "exit_on_any_state_change": true,
      "use_yellow_ema_trail": true,
      "trailing_ema": 15,
      "trailing_buffer_pct": 0.00075,
      "min_light_emas_to_hold": 4
    },
    "min_hold_time_minutes": 15,
    "exit_on_ribbon_flip": false,
    "exit_on_target_only": false,
    "profit_target_pct": 0.008,
    "use_yellow_ema_trail": true,
    "yellow_ema_trail_buffer_pct": 0.0015
  },
  "trend_strength_analysis": {
    "enabled": true,
    "description": "Calculate trend strength score to validate entries and exits",
    "light_ema_ratio_weight": 25,
    "ema_spread_weight": 20,
    "ribbon_stability_weight": 20,
    "slope_alignment_weight": 20,
    "price_conviction_weight": 15,
    "thresholds": {
      "strong_trend": 70,
      "moderate_trend": 50,
      "weak_trend": 30
    },
    "ema_spread_thresholds": {
      "expanding": 0.003,
      "stable": 0.001,
      "compressing": 0.0005
    },
    "ribbon_stability_thresholds": {
      "very_stable": 20,
      "stable": 10,
      "unstable": 5
    }
  },
  "choppy_market_detection": {
    "enabled": true,
    "description": "Detect and avoid choppy/ranging market conditions",
    "flip_count_30min_threshold": 5,
    "ema_compression_threshold": 0.0005,
    "light_ema_changes_5min_threshold": 6,
    "avoid_entry_choppy_score": 70,
    "exit_if_choppy_score": 60
  },
  "pattern_rules": {
    "path_e_dark_transition": {
      "enabled": true,
      "priority": 2,
      "confidence_boost": 0.15,
      "entry_window_seconds": 10
    },
    "path_d_early_reversal": {
      "enabled": true,
      "priority": 4,
      "min_light_emas_opposite": 8,
      "min_green_appearing": 2,
      "confidence_threshold": 0.75
    },
    "path_c_wick_reversal": {
      "enabled": true,
      "priority": 3,
      "min_wick_pct": 0.003,
      "max_wick_pct": 0.008,
      "confidence_boost": 0.2
    },
    "path_a_trending": {
      "enabled": true,
      "priority": 5,
      "min_range_pct": 0.005,
      "price_location_lower_pct": 0.5,
      "price_location_upper_pct": 0.5,
      "min_alignment_pct": 0.85
    },
    "path_b_breakout": {
      "enabled": true,
      "priority": 6,
      "max_range_pct": 0.004,
      "min_breakout_pct": 0.0015,
      "ribbon_flip_max_minutes": 8
    },
    "path_f_momentum_surge": {
      "enabled": true,
      "priority": 1,
      "min_light_emas": 25,
      "ignore_all_other_filters": true,
      "confidence_boost": 0.9,
      "special_profit_target_pct": 0.008,
      "entry_window_seconds": 300,
      "upward_bias_multiplier": 1.5
    }
  },
  "performance_metrics": {
    "total_trades_executed": 0,
    "winning_trades": 0,
    "losing_trades": 0,
    "win_rate": 0.0,
    "avg_winner_pnl_pct": 0.0,
    "avg_loser_pnl_pct": 0.0,
    "best_pattern": "unknown",
    "worst_pattern": "unknown",
    "tier_1_trades": 0,
    "tier_2_trades": 0,
    "tier_3_trades": 0,
    "tier_1_avg_hold_minutes": 0,
    "tier_2_avg_hold_minutes": 0,
    "tier_3_avg_hold_minutes": 0
  },
  "claude_insights": {
    "last_optimization": "2025-10-21T04:03:31.331124",
    "key_findings": [
      "Finding 1: CRITICAL EXECUTION FAILURE - Zero actual trades vs 1078 backtest trades indicates complete bot malfunction. This is a technical emergency requiring immediate system audit of API connectivity, parameter sync, and execution logic.",
      "Finding 2: MASSIVE OVER-TRADING CRISIS - Taking 11,977% more trades than optimal (1078 vs 9) with negative returns proves our filters are fundamentally broken, catching noise instead of signal patterns.",
      "Finding 3: MISSING BIG MOVEMENT DETECTION - No big movement analysis available means we're blind to the high-value momentum patterns that generated the optimal +6.23% performance from just 9 trades.",
      "Finding 4: FILTER PARADOX - Despite ultra-restrictive settings (0.999 alignment, 35+ light EMAs), we're still massively over-trading, indicating our current filters target wrong patterns entirely.",
      "Finding 5: OPTIMIZATION FAILURE - 43 rule versions with zero documented improvements suggests our learning process isn't extracting actionable insights from the data patterns."
    ],
    "pattern_recommendations": [
      "EMERGENCY PRIORITY: Immediately audit and fix bot execution system - check API connections, real-time data feeds, parameter synchronization, and trade execution pipeline",
      "IMPLEMENT MOMENTUM SURGE DETECTION: Create path_f_momentum_surge as highest priority pattern to catch the big movements that optimal trades captured, with ability to override restrictive filters",
      "ADD BIG MOVEMENT EARLY WARNING: Implement volume surge detection (2.0x+ threshold) and significant price movement detection (0.008%+ in 5min) to catch opportunities in development phase",
      "DRASTICALLY REDUCE TRADE FREQUENCY: Target 95%+ reduction in trades by implementing ultra-selective criteria - aim for 10-15 trades maximum to match optimal frequency patterns",
      "CREATE MOMENTUM OVERRIDE SYSTEM: Allow confirmed big movement patterns to bypass stale transition filters, compression requirements, and normal position restrictions"
    ],
    "rule_adjustments": {
      "ribbon_alignment_threshold": 0.999,
      "min_light_emas_required": 35,
      "max_hold_minutes": 480,
      "entry_rules": {
        "NEW_big_movement_detection": {
          "enabled": true,
          "min_price_move_pct": 0.008,
          "volume_surge_threshold": 2.0,
          "ignore_stale_on_big_move": true,
          "ignore_compression_on_big_move": true
        },
        "NEW_momentum_filters": {
          "min_ema_spread_pct": 0.006,
          "dark_to_light_transition_boost": 0.5,
          "require_expanding_ribbon": true
        },
        "min_compression_for_entry": 0.004,
        "fresh_transition_max_minutes": 3,
        "min_ribbon_stability_minutes": 20,
        "stale_transition_min_minutes": 45
      },
      "exit_rules": {
        "tier_1_strong_trend": {
          "min_hold_minutes": 45,
          "profit_target_pct": 0.022,
          "stop_loss_pct": 0.012,
          "exit_on_ribbon_flip": false,
          "exit_on_opposite_strong_state": false,
          "min_light_emas_to_hold": 20,
          "trailing_buffer_pct": 0.002
        },
        "tier_2_moderate_trend": {
          "min_hold_minutes": 30,
          "profit_target_pct": 0.018,
          "stop_loss_pct": 0.01,
          "min_light_emas_to_hold": 15,
          "trailing_buffer_pct": 0.002
        }
      },
      "pattern_rules": {
        "NEW_path_f_momentum_surge": {
          "enabled": true,
          "priority": 1,
          "min_light_emas": 40,
          "ignore_all_other_filters": true,
          "confidence_boost": 1.2,
          "special_profit_target_pct": 0.025,
          "entry_window_seconds": 60,
          "upward_bias_multiplier": 2.0,
          "volume_confirmation_required": true
        },
        "NEW_big_movement_priority": {
          "enabled": true,
          "entry_overrides": {
            "ignore_stale_filter": true,
            "ignore_position_location_filter": true,
            "ignore_compression_filter": true,
            "ignore_ribbon_stability_filter": true
          }
        },
        "path_e_dark_transition": {
          "enabled": true,
          "priority": 2,
          "min_light_emas_required": 25,
          "confidence_boost": 0.3
        }
      },
      "path_priorities": {
        "NEW_path_f_momentum_surge": 1,
        "path_e_dark_transition": 2,
        "path_c_wick_reversal": 3,
        "path_d_early_reversal": 4,
        "path_a_trending": 5,
        "path_b_breakout": 6
      },
      "choppy_market_detection": {
        "avoid_entry_choppy_score": 80,
        "exit_if_choppy_score": 70,
        "flip_count_30min_threshold": 3
      }
    },
    "reasoning": "The data reveals a catastrophic system failure requiring both emergency technical intervention and radical strategy overhaul. With zero actual trades vs 1078 backtest trades, the bot execution system is completely broken and needs immediate repair. The 11,977% over-trading rate with negative returns proves our filters are fundamentally flawed - we're catching noise, not the signal patterns that generated optimal's +6.23% from just 9 trades. The solution is three-pronged: 1) Emergency bot system audit and repair, 2) Implement momentum surge detection (path_f) as highest priority to catch the big movements optimal trades found, 3) Dramatically tighten all thresholds (0.999 alignment, 35+ light EMAs, 0.006% spread, 20min stability) to reduce trades by 95%+. The new big movement detection system with override capabilities should capture high-value patterns while ultra-restrictive base filters eliminate noise. Increased profit targets (2.2-2.5%) and hold times (45+ min) match the characteristics of successful optimal trades. This creates a barbell strategy: ultra-selective base rules with momentum surge overrides for exceptional opportunities."
  }
}